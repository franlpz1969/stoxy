<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stoxy - Gestión de Inversiones y Mercados en Tiempo Real</title>
    <meta name="description"
        content="Plataforma completa para seguimiento de mercados, gestión de carteras de inversión, análisis de acciones, criptomonedas y noticias financieras en tiempo real.">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="mobile-enhancements.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <!-- Chart.js for professional charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body>
    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleMobileSidebar()"></div>

    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                    <path d="M16 2L2 9L16 16L30 9L16 2Z" fill="url(#gradient1)" />
                    <path d="M2 23L16 30L30 23V9L16 16L2 9V23Z" fill="url(#gradient2)" />
                    <defs>
                        <linearGradient id="gradient1" x1="2" y1="2" x2="30" y2="16">
                            <stop offset="0%" stop-color="#667eea" />
                            <stop offset="100%" stop-color="#764ba2" />
                        </linearGradient>
                        <linearGradient id="gradient2" x1="2" y1="9" x2="30" y2="30">
                            <stop offset="0%" stop-color="#f093fb" />
                            <stop offset="100%" stop-color="#f5576c" />
                        </linearGradient>
                    </defs>
                </svg>
                <span class="logo-text">Stoxy</span>
            </div>
            <button class="sidebar-toggle" id="sidebarToggle">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M3 12h18M3 6h18M3 18h18" stroke-width="2" stroke-linecap="round" />
                </svg>
            </button>
        </div>

        <nav class="sidebar-nav">
            <a href="#" class="nav-item active" data-page="dashboard">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <rect x="3" y="3" width="7" height="7" stroke-width="2" />
                    <rect x="14" y="3" width="7" height="7" stroke-width="2" />
                    <rect x="14" y="14" width="7" height="7" stroke-width="2" />
                    <rect x="3" y="14" width="7" height="7" stroke-width="2" />
                </svg>
                <span>Dashboard</span>
            </a>
            <a href="#" class="nav-item" data-page="portfolio">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M20 7h-9M14 17H5M18 12l-3-3m0 6l3-3" stroke-width="2" stroke-linecap="round" />
                    <circle cx="5" cy="7" r="2" stroke-width="2" />
                    <circle cx="19" cy="17" r="2" stroke-width="2" />
                </svg>
                <span>Mi Cartera</span>
            </a>
            <a href="#" class="nav-item" data-page="markets">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M3 3v18h18" stroke-width="2" stroke-linecap="round" />
                    <path d="M7 16l4-8 4 4 4-6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <span>Mercados</span>
            </a>
            <a href="#" class="nav-item" data-page="crypto">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <circle cx="12" cy="12" r="9" stroke-width="2" />
                    <path d="M9 8h6M9 12h6M9 16h4" stroke-width="2" stroke-linecap="round" />
                </svg>
                <span>Criptomonedas</span>
            </a>
            <a href="#" class="nav-item" data-page="news">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"
                        stroke-width="2" />
                    <path d="M7 7h10M7 11h10M7 15h6" stroke-width="2" stroke-linecap="round" />
                </svg>
                <span>Noticias</span>
            </a>
            <a href="#" class="nav-item" data-page="alerts">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 0 1-3.46 0" stroke-width="2"
                        stroke-linecap="round" />
                </svg>
                <span>Alertas</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <div class="user-profile">
                <div class="user-avatar">
                    <span>FG</span>
                </div>
                <div class="user-info">
                    <div class="user-name">Francisco</div>
                    <div class="user-status">Inversor Pro</div>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <!-- Mobile Menu Toggle -->
                <button class="mobile-menu-toggle" id="mobileMenuToggle" onclick="toggleMobileSidebar()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M3 12h18M3 6h18M3 18h18" stroke-width="2" stroke-linecap="round" />
                    </svg>
                </button>

                <h1 class="page-title">Dashboard</h1>

                <!-- Portfolio Selector -->
                <div class="portfolio-selector">
                    <button class="portfolio-selector-btn" id="portfolioSelectorBtn"
                        onclick="togglePortfolioDropdown()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" stroke-width="2" />
                            <polyline points="9 22 9 12 15 12 15 22" stroke-width="2" />
                        </svg>
                        <span id="currentPortfolioName">Cartera Principal</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M6 9l6 6 6-6" stroke-width="2" stroke-linecap="round" />
                        </svg>
                    </button>
                    <div class="portfolio-dropdown" id="portfolioDropdown">
                        <div class="portfolio-dropdown-header">
                            <span>Mis Carteras</span>
                            <button class="icon-button-small" onclick="openModal('createPortfolioModal')"
                                title="Nueva Cartera">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M12 5v14M5 12h14" stroke-width="2" stroke-linecap="round" />
                                </svg>
                            </button>
                        </div>
                        <div class="portfolio-list" id="portfolioList">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="market-status">
                    <span class="status-indicator active"></span>
                    <span>Mercados Abiertos</span>
                </div>
            </div>
            <div class="header-right">
                <div class="search-bar" style="position: relative;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="11" cy="11" r="8" stroke-width="2" />
                        <path d="M21 21l-4.35-4.35" stroke-width="2" stroke-linecap="round" />
                    </svg>
                    <input type="text" placeholder="Buscar acciones, ETFs, cripto..." id="searchInput">
                    <div id="searchResults" class="search-results" style="display: none;"></div>
                </div>
                <button class="icon-button notification-btn" onclick="toggleNotificationsPanel()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 0 1-3.46 0"
                            stroke-width="2" />
                    </svg>
                    <span class="notification-badge">3</span>
                </button>
            </div>
        </header>

        <!-- Dashboard Content -->
        <div class="content-area" id="contentArea">
            <!-- Dashboard Page -->
            <div class="page-section" id="dashboardPage" style="display: block;">
                <!-- Portfolio Summary Cards -->
                <div class="summary-cards">
                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">Valor Total</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" stroke-width="2"
                                    stroke-linecap="round" />
                            </svg>
                        </div>
                        <div class="card-value">€127,458.32</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M18 15l-6-6-6 6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>+€4,234.12 (3.43%)</span>
                        </div>
                        <div class="chart-wrapper mini-chart-wrapper"><canvas id="totalValueChart"></canvas></div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">Ganancia Hoy</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M3 3v18h18" stroke-width="2" />
                                <path d="M7 16l4-8 4 4 4-6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                        </div>
                        <div class="card-value">€1,842.67</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M18 15l-6-6-6 6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>+1.47%</span>
                        </div>
                        <div class="chart-wrapper mini-chart-wrapper"><canvas id="todayGainChart"></canvas></div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">Acciones</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="3" y="3" width="18" height="18" rx="2" stroke-width="2" />
                                <path d="M3 9h18M9 21V9" stroke-width="2" />
                            </svg>
                        </div>
                        <div class="card-value">€89,234.50</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M18 15l-6-6-6 6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>+2.18%</span>
                        </div>
                        <div class="chart-wrapper mini-chart-wrapper"><canvas id="stocksChart"></canvas></div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">Criptomonedas</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <circle cx="12" cy="12" r="9" stroke-width="2" />
                                <path d="M9 8h6M9 12h6M9 16h4" stroke-width="2" />
                            </svg>
                        </div>
                        <div class="card-value">€38,223.82</div>
                        <div class="card-change negative">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M6 9l6 6 6-6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>-0.82%</span>
                        </div>
                        <div class="chart-wrapper mini-chart-wrapper"><canvas id="cryptoChart"></canvas></div>
                    </div>
                </div>

                <!-- Main Chart and Watchlist -->
                <div class="dashboard-grid">
                    <div class="chart-container">
                        <div class="chart-header">
                            <h2>Rendimiento de Cartera</h2>
                            <div class="chart-controls">
                                <button class="time-btn active" data-period="1D">1D</button>
                                <button class="time-btn" data-period="1W">1S</button>
                                <button class="time-btn" data-period="1M">1M</button>
                                <button class="time-btn" data-period="3M">3M</button>
                                <button class="time-btn" data-period="1Y">1A</button>
                                <button class="time-btn" data-period="ALL">Todo</button>
                            </div>
                        </div>
                        <div class="chart-wrapper main-chart-wrapper"><canvas id="mainChart"></canvas></div>
                    </div>

                    <div class="watchlist-container">
                        <div class="watchlist-header">
                            <h2>Lista de Seguimiento</h2>
                            <button class="icon-button">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path d="M12 5v14M5 12h14" stroke-width="2" stroke-linecap="round" />
                                </svg>
                            </button>
                        </div>
                        <div class="watchlist-items" id="watchlistItems"></div>
                    </div>
                </div>

                <!-- Holdings and News -->
                <div class="dashboard-grid-2">
                    <div class="holdings-container">
                        <div class="section-header">
                            <h2>Mis Inversiones</h2>
                            <div class="header-actions">
                                <button class="icon-button" onclick="openModal('addPositionModal')"
                                    title="Añadir Posición">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path d="M12 5v14M5 12h14" stroke-width="2" stroke-linecap="round" />
                                    </svg>
                                </button>
                                <button class="text-button">Ver todas →</button>
                            </div>
                        </div>
                        <div class="holdings-table" id="holdingsTable"></div>
                    </div>

                    <div class="news-container">
                        <div class="section-header">
                            <h2>Noticias Financieras</h2>
                            <button class="text-button">Ver más →</button>
                        </div>
                        <div class="news-feed" id="newsFeed"></div>
                    </div>
                </div>

                <!-- Floating Action Buttons -->
                <div class="fab-container">
                    <button class="fab" onclick="openModal('calculatorModal')" title="Calculadora">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <rect x="4" y="2" width="16" height="20" rx="2" stroke-width="2" />
                            <line x1="8" y1="6" x2="16" y2="6" stroke-width="2" />
                            <line x1="8" y1="10" x2="16" y2="10" stroke-width="2" />
                            <line x1="8" y1="14" x2="12" y2="14" stroke-width="2" />
                            <line x1="8" y1="18" x2="12" y2="18" stroke-width="2" />
                        </svg>
                    </button>
                    <button class="fab fab-alert" onclick="openModal('createAlertModal')" title="Crear Alerta">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke-width="2" />
                            <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke-width="2" />
                        </svg>
                    </button>
                </div>
            </div>
            <!-- End Dashboard Page -->

            <!-- Portfolio Page -->
            <div class="page-section" id="portfolioPage" style="display: none;">
                <div class="section-header" style="margin-bottom: 2rem;">
                    <h2>Mi Cartera</h2>
                    <p style="color: var(--text-secondary); margin-top: 0.5rem;">Gestión completa de tu cartera de
                        inversiones</p>
                </div>

                <!-- Portfolio Summary -->
                <div class="summary-cards">
                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">Valor Total</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" stroke-width="2"
                                    stroke-linecap="round" />
                            </svg>
                        </div>
                        <div class="card-value" id="portfolioTotalValue">€127,458.32</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M18 15l-6-6-6 6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>+€4,234.12 (3.43%)</span>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">Rentabilidad Total</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M3 3v18h18" stroke-width="2" />
                                <path d="M7 16l4-8 4 4 4-6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                        </div>
                        <div class="card-value positive" style="color: var(--success);">+18.45%</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M18 15l-6-6-6 6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>+€19,876.54 desde inicio</span>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">Número de Posiciones</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <rect x="3" y="3" width="18" height="18" rx="2" stroke-width="2" />
                                <path d="M3 9h18M9 21V9" stroke-width="2" />
                            </svg>
                        </div>
                        <div class="card-value">8</div>
                        <div class="card-change" style="color: var(--text-secondary);">
                            <span>5 acciones, 3 criptos</span>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">Dividendos Recibidos</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <circle cx="12" cy="12" r="9" stroke-width="2" />
                                <path d="M9 8h6M9 12h6M9 16h4" stroke-width="2" />
                            </svg>
                        </div>
                        <div class="card-value">€1,234.56</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M18 15l-6-6-6 6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>+€89.00 este mes</span>
                        </div>
                    </div>
                </div>

                <!-- Portfolio Holdings -->
                <div class="dashboard-grid" style="margin-top: 2rem;">
                    <div class="holdings-container">
                        <div class="section-header">
                            <h2>Mis Posiciones</h2>
                            <div class="header-actions">
                                <button class="icon-button" onclick="openModal('addPositionModal')"
                                    title="Añadir Posición">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path d="M12 5v14M5 12h14" stroke-width="2" stroke-linecap="round" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="holdings-table" id="portfolioHoldingsTable">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <div class="chart-container">
                        <div class="chart-header">
                            <h2>Distribución de Activos</h2>
                        </div>
                        <div class="chart-wrapper main-chart-wrapper">
                            <canvas id="portfolioAllocationChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Transactions -->
                <div class="holdings-container" style="margin-top: 2rem;">
                    <div class="section-header">
                        <h2>Transacciones Recientes</h2>
                        <button class="text-button">Ver historial completo →</button>
                    </div>
                    <div class="holdings-table">
                        <div class="holding-row">
                            <div class="holding-asset">
                                <div class="holding-icon" style="background: var(--success);">C</div>
                                <div class="holding-details">
                                    <h4>Compra AAPL</h4>
                                    <p>10 acciones @ $178.50</p>
                                </div>
                            </div>
                            <div class="holding-value">$1,785.00</div>
                            <div class="holding-change" style="color: var(--text-secondary);">Hace 2 días</div>
                        </div>
                        <div class="holding-row">
                            <div class="holding-asset">
                                <div class="holding-icon" style="background: var(--success);">C</div>
                                <div class="holding-details">
                                    <h4>Compra ETH</h4>
                                    <p>2 ETH @ $2,100.00</p>
                                </div>
                            </div>
                            <div class="holding-value">$4,200.00</div>
                            <div class="holding-change" style="color: var(--text-secondary);">Hace 5 días</div>
                        </div>
                        <div class="holding-row">
                            <div class="holding-asset">
                                <div class="holding-icon" style="background: var(--danger);">V</div>
                                <div class="holding-details">
                                    <h4>Venta TSLA</h4>
                                    <p>5 acciones @ $245.00</p>
                                </div>
                            </div>
                            <div class="holding-value">$1,225.00</div>
                            <div class="holding-change positive">+12.5%</div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Portfolio Page -->

            <!-- Markets Page -->
            <div class="page-section" id="marketsPage" style="display: none;">
                <div class="section-header" style="margin-bottom: 2rem;">
                    <h2>Mercados Globales</h2>
                    <p style="color: var(--text-secondary); margin-top: 0.5rem;">Seguimiento de índices y mercados en
                        tiempo real</p>
                </div>

                <div class="summary-cards">
                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">S&P 500</span>
                        </div>
                        <div class="card-value">4,783.45</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M18 15l-6-6-6 6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>+0.85%</span>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">NASDAQ</span>
                        </div>
                        <div class="card-value">15,011.35</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M18 15l-6-6-6 6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>+1.24%</span>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">IBEX 35</span>
                        </div>
                        <div class="card-value">10,234.67</div>
                        <div class="card-change negative">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M6 9l6 6 6-6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>-0.32%</span>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">DAX</span>
                        </div>
                        <div class="card-value">16,789.23</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M18 15l-6-6-6 6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>+0.56%</span>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid" style="margin-top: 2rem;">
                    <div class="chart-container">
                        <div class="chart-header">
                            <h2>Índices Principales</h2>
                        </div>
                        <div style="padding: 3rem; text-align: center; color: var(--text-secondary);">
                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                style="margin: 0 auto 1rem;">
                                <path d="M3 3v18h18" stroke-width="2" stroke-linecap="round" />
                                <path d="M7 16l4-8 4 4 4-6" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                            <p>Gráficos de mercados disponibles próximamente</p>
                        </div>
                    </div>

                    <div class="watchlist-container">
                        <div class="watchlist-header">
                            <h2>Top Movers</h2>
                        </div>
                        <div class="watchlist-items" id="marketsTopMovers">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Markets Page -->

            <!-- Crypto Page -->
            <div class="page-section" id="cryptoPage" style="display: none;">
                <div class="section-header" style="margin-bottom: 2rem;">
                    <h2>Criptomonedas</h2>
                    <p style="color: var(--text-secondary); margin-top: 0.5rem;">Mercado de criptomonedas en tiempo real
                    </p>
                </div>

                <div class="summary-cards">
                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">Bitcoin</span>
                        </div>
                        <div class="card-value">$43,567.89</div>
                        <div class="card-change negative">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M6 9l6 6 6-6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>-0.54%</span>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">Ethereum</span>
                        </div>
                        <div class="card-value">$2,289.45</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M18 15l-6-6-6 6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>+2.12%</span>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">Cardano</span>
                        </div>
                        <div class="card-value">$0.58</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M18 15l-6-6-6 6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>+3.45%</span>
                        </div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <span class="card-label">Solana</span>
                        </div>
                        <div class="card-value">$98.23</div>
                        <div class="card-change positive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M18 15l-6-6-6 6" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span>+5.67%</span>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid" style="margin-top: 2rem;">
                    <div class="chart-container">
                        <div class="chart-header">
                            <h2>Capitalización de Mercado</h2>
                        </div>
                        <div style="padding: 3rem; text-align: center; color: var(--text-secondary);">
                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                style="margin: 0 auto 1rem;">
                                <circle cx="12" cy="12" r="9" stroke-width="2" />
                                <path d="M9 8h6M9 12h6M9 16h4" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <p>Gráficos de criptomonedas disponibles próximamente</p>
                        </div>
                    </div>

                    <div class="watchlist-container">
                        <div class="watchlist-header">
                            <h2>Top Cryptos</h2>
                        </div>
                        <div class="watchlist-items" id="cryptoTopList">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Crypto Page -->

            <!-- News Page -->
            <div class="page-section" id="newsPage" style="display: none;">
                <div class="section-header" style="margin-bottom: 2rem;">
                    <h2>Noticias Financieras</h2>
                    <p style="color: var(--text-secondary); margin-top: 0.5rem;">Últimas noticias del mundo financiero
                    </p>
                </div>

                <div class="news-container" style="max-width: 100%;">
                    <div class="news-feed" id="newsPageFeed">
                        <div class="news-item">
                            <div class="news-image-placeholder"
                                style="width: 120px; height: 120px; border-radius: 0.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            </div>
                            <div class="news-content">
                                <div class="news-source">Bloomberg</div>
                                <div class="news-title">Los mercados alcanzan nuevos máximos históricos impulsados por
                                    el sector tecnológico</div>
                                <div class="news-time">Hace 2 horas</div>
                            </div>
                        </div>

                        <div class="news-item">
                            <div class="news-image-placeholder"
                                style="width: 120px; height: 120px; border-radius: 0.5rem; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            </div>
                            <div class="news-content">
                                <div class="news-source">CNBC</div>
                                <div class="news-title">Bitcoin supera los $44,000 en medio de creciente interés
                                    institucional</div>
                                <div class="news-time">Hace 4 horas</div>
                            </div>
                        </div>

                        <div class="news-item">
                            <div class="news-image-placeholder"
                                style="width: 120px; height: 120px; border-radius: 0.5rem; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                            </div>
                            <div class="news-content">
                                <div class="news-source">Wall Street Journal</div>
                                <div class="news-title">Apple anuncia nuevos productos y servicios para 2024</div>
                                <div class="news-time">Hace 6 horas</div>
                            </div>
                        </div>

                        <div class="news-item">
                            <div class="news-image-placeholder"
                                style="width: 120px; height: 120px; border-radius: 0.5rem; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                            </div>
                            <div class="news-content">
                                <div class="news-source">Financial Times</div>
                                <div class="news-title">La Fed mantiene las tasas de interés sin cambios</div>
                                <div class="news-time">Hace 8 horas</div>
                            </div>
                        </div>

                        <div class="news-item">
                            <div class="news-image-placeholder"
                                style="width: 120px; height: 120px; border-radius: 0.5rem; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                            </div>
                            <div class="news-content">
                                <div class="news-source">Reuters</div>
                                <div class="news-title">Tesla reporta ganancias récord en el último trimestre</div>
                                <div class="news-time">Hace 10 horas</div>
                            </div>
                        </div>

                        <div class="news-item">
                            <div class="news-image-placeholder"
                                style="width: 120px; height: 120px; border-radius: 0.5rem; background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                            </div>
                            <div class="news-content">
                                <div class="news-source">MarketWatch</div>
                                <div class="news-title">Análisis: ¿Es el momento adecuado para invertir en tecnología?
                                </div>
                                <div class="news-time">Hace 12 horas</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End News Page -->

            <!-- Alerts Page -->
            <div class="page-section" id="alertsPage" style="display: none;">
                <div class="section-header" style="margin-bottom: 2rem;">
                    <h2>Mis Alertas</h2>
                    <p style="color: var(--text-secondary); margin-top: 0.5rem;">Gestiona tus alertas de precio y
                        notificaciones</p>
                </div>

                <div class="dashboard-grid-2">
                    <div class="holdings-container">
                        <div class="section-header">
                            <h2>Alertas Activas</h2>
                            <div class="header-actions">
                                <button class="icon-button" onclick="openModal('createAlertModal')"
                                    title="Crear Alerta">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                        <path d="M12 5v14M5 12h14" stroke-width="2" stroke-linecap="round" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div id="alertsListContainer"
                            style="padding: 2rem; text-align: center; color: var(--text-secondary);">
                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                style="margin: 0 auto 1rem; opacity: 0.5;">
                                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke-width="2" />
                                <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke-width="2" />
                            </svg>
                            <p>Crea alertas para recibir notificaciones cuando tus activos alcancen ciertos precios</p>
                            <button class="btn-primary" onclick="openModal('createAlertModal')"
                                style="margin-top: 1rem;">
                                Crear Primera Alerta
                            </button>
                        </div>
                    </div>

                    <div class="news-container">
                        <div class="section-header">
                            <h2>Historial de Alertas</h2>
                        </div>
                        <div style="padding: 2rem; text-align: center; color: var(--text-secondary);">
                            <p>Aquí verás el historial de alertas activadas</p>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Alerts Page -->

        </div>
    </main>

    <!-- Modals -->
    <!-- Add Position Modal -->
    <div class="modal" id="addPositionModal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>Añadir Posición</h2>
                <button class="modal-close" onclick="closeModal('addPositionModal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M18 6L6 18M6 6l12 12" stroke-width="2" stroke-linecap="round" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="addPositionForm">
                    <div class="form-group">
                        <label>Símbolo</label>
                        <input type="text" id="symbolInput" placeholder="AAPL, BTC, ETH..." required>
                    </div>
                    <div class="form-group">
                        <label>Tipo de Activo</label>
                        <select id="assetTypeInput" required>
                            <option value="stock">Acción</option>
                            <option value="crypto">Criptomoneda</option>
                            <option value="etf">ETF</option>
                            <option value="commodity">Materia Prima</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Cantidad</label>
                            <input type="number" id="quantityInput" step="0.00000001" placeholder="0.00" required>
                        </div>
                        <div class="form-group">
                            <label>Precio de Compra</label>
                            <input type="number" id="priceInput" step="0.01" placeholder="0.00" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Fecha de Compra</label>
                        <input type="date" id="dateInput" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary"
                            onclick="closeModal('addPositionModal')">Cancelar</button>
                        <button type="submit" class="btn-primary">Añadir Posición</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Create Alert Modal -->
    <div class="modal" id="createAlertModal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>Crear Alerta de Precio</h2>
                <button class="modal-close" onclick="closeModal('createAlertModal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M18 6L6 18M6 6l12 12" stroke-width="2" stroke-linecap="round" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="createAlertForm">
                    <div class="form-group">
                        <label>Activo</label>
                        <input type="text" id="alertSymbolInput" placeholder="AAPL, BTC, TSLA..." required>
                    </div>
                    <div class="form-group">
                        <label>Condición</label>
                        <select id="alertConditionInput" required>
                            <option value="above">Precio por encima de</option>
                            <option value="below">Precio por debajo de</option>
                            <option value="change">Cambio porcentual mayor a</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Valor Objetivo</label>
                        <input type="number" id="alertValueInput" step="0.01" placeholder="0.00" required>
                    </div>
                    <div class="form-group">
                        <label>Tipo de Notificación</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" checked> Notificación Push
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" checked> Email
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox"> SMS
                            </label>
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary"
                            onclick="closeModal('createAlertModal')">Cancelar</button>
                        <button type="submit" class="btn-primary">Crear Alerta</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Investment Calculator Modal -->
    <div class="modal" id="calculatorModal">
        <div class="modal-overlay"></div>
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Calculadora de Inversiones</h2>
                <button class="modal-close" onclick="closeModal('calculatorModal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M18 6L6 18M6 6l12 12" stroke-width="2" stroke-linecap="round" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="calculator-grid">
                    <div class="calculator-inputs">
                        <h3>Parámetros de Inversión</h3>
                        <div class="form-group">
                            <label>Inversión Inicial (€)</label>
                            <input type="number" id="calcInitialInput" value="10000" step="100">
                        </div>
                        <div class="form-group">
                            <label>Aportación Mensual (€)</label>
                            <input type="number" id="calcMonthlyInput" value="500" step="50">
                        </div>
                        <div class="form-group">
                            <label>Rentabilidad Anual (%)</label>
                            <input type="number" id="calcReturnInput" value="8" step="0.5">
                        </div>
                        <div class="form-group">
                            <label>Período (años)</label>
                            <input type="number" id="calcYearsInput" value="10" min="1" max="50">
                        </div>
                        <button class="btn-primary" onclick="calculateInvestment()">Calcular</button>
                    </div>
                    <div class="calculator-results">
                        <h3>Resultados Proyectados</h3>
                        <div class="result-card">
                            <div class="result-label">Valor Final</div>
                            <div class="result-value" id="calcFinalValue">€0.00</div>
                        </div>
                        <div class="result-card">
                            <div class="result-label">Total Invertido</div>
                            <div class="result-value" id="calcTotalInvested">€0.00</div>
                        </div>
                        <div class="result-card">
                            <div class="result-label">Ganancias</div>
                            <div class="result-value positive" id="calcGains">€0.00</div>
                        </div>
                        <div class="chart-wrapper calculator-chart-wrapper"><canvas id="calculatorChart"></canvas></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Technical Analysis Toolbar (appears when viewing charts) -->
    <div class="chart-toolbar" id="chartToolbar" style="display: none;">
        <div class="toolbar-group">
            <button class="toolbar-btn active" data-chart="candlestick" title="Velas">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <rect x="8" y="4" width="8" height="16" stroke-width="2" />
                    <line x1="12" y1="4" x2="12" y2="2" stroke-width="2" />
                    <line x1="12" y1="20" x2="12" y2="22" stroke-width="2" />
                </svg>
            </button>
            <button class="toolbar-btn" data-chart="line" title="Línea">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <polyline points="3 17 9 11 13 15 21 7" stroke-width="2" />
                </svg>
            </button>
            <button class="toolbar-btn" data-chart="area" title="Área">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M3 17L9 11L13 15L21 7V21H3V17Z" stroke-width="2" />
                </svg>
            </button>
        </div>
        <div class="toolbar-divider"></div>
        <div class="toolbar-group">
            <button class="toolbar-btn" data-indicator="sma" title="Media Móvil">SMA</button>
            <button class="toolbar-btn" data-indicator="ema" title="Media Exponencial">EMA</button>
            <button class="toolbar-btn" data-indicator="bollinger" title="Bandas de Bollinger">BB</button>
            <button class="toolbar-btn" data-indicator="rsi" title="RSI">RSI</button>
            <button class="toolbar-btn" data-indicator="macd" title="MACD">MACD</button>
        </div>
    </div>

    <!-- Create Portfolio Modal -->
    <div class="modal" id="createPortfolioModal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>Crear Nueva Cartera</h2>
                <button class="modal-close" onclick="closeModal('createPortfolioModal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M18 6L6 18M6 6l12 12" stroke-width="2" stroke-linecap="round" />
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="createPortfolioForm">
                    <div class="form-group">
                        <label>Nombre de la Cartera</label>
                        <input type="text" id="portfolioNameInput" placeholder="Mi Cartera de Tecnología" required>
                    </div>
                    <div class="form-group">
                        <label>Descripción (Opcional)</label>
                        <textarea id="portfolioDescInput" rows="3"
                            placeholder="Descripción de tu cartera..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Moneda Base</label>
                        <select id="portfolioCurrencyInput" required>
                            <option value="EUR">EUR (€)</option>
                            <option value="USD">USD ($)</option>
                            <option value="GBP">GBP (£)</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary"
                            onclick="closeModal('createPortfolioModal')">Cancelar</button>
                        <button type="submit" class="btn-primary">Crear Cartera</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Notifications Panel -->
    <div class="notifications-panel" id="notificationsPanel" style="display: none;">
        <div class="notifications-header">
            <h3>Notificaciones</h3>
            <button class="icon-button-small" onclick="toggleNotificationsPanel()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M18 6L6 18M6 6l12 12" stroke-width="2" stroke-linecap="round" />
                </svg>
            </button>
        </div>
        <div class="notifications-list" id="notificationsList">
            <!-- Populated by JavaScript -->
            <div class="notification-item unread">
                <div class="notification-icon success">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M20 6L9 17l-5-5" stroke-width="2" stroke-linecap="round" />
                    </svg>
                </div>
                <div class="notification-content">
                    <div class="notification-title">Alerta Activada</div>
                    <div class="notification-message">AAPL alcanzó $150.00</div>
                    <div class="notification-time">Hace 5 minutos</div>
                </div>
            </div>
            <div class="notification-item">
                <div class="notification-icon info">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="12" cy="12" r="10" stroke-width="2" />
                        <path d="M12 16v-4M12 8h.01" stroke-width="2" stroke-linecap="round" />
                    </svg>
                </div>
                <div class="notification-content">
                    <div class="notification-title">Actualización de Mercado</div>
                    <div class="notification-message">S&P 500 subió +0.85%</div>
                    <div class="notification-time">Hace 1 hora</div>
                </div>
            </div>
        </div>
    </div>

    <script src="api-client.js"></script>
    <script src="storage.js"></script>
    <script src="enhancements.js"></script>
    <script src="app.js?v=2.0"></script>
    <script src="charts.js"></script>
    <script src="calculator.js"></script>
</body>

</html>